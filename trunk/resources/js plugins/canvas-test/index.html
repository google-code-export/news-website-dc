<html>
	<head>
		<title>Canvas Drawing Demo</title>
		<style type="text/css">
			body {
				background: #222;
			}
			#wrapper {
				width: 1000px;
				margin: 0 auto;
			}
			canvas {
				background: #FFF9BC;
				margin: 5px 0;
			}
		</style>
		<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
		<!--[if lt IE 9]>
			<script type="text/javascript" src="excanvas.min.js"></script>
		<![endif]-->
		<script type="text/javascript">
			$(function() {
				drawCanvas();
			});
			
			function drawCanvas() {
				drawBarChart();
				drawPieChart(300, 200, 185, true);
				drawPieChart(700, 200, 125, false);
			}
			
			function drawBarChart() {
				// Get canvas context
				var ctx = $("#barChartCanvas").get(0).getContext("2d");
				// Clear current canvas
				clearCanvas(ctx);
				// Draw bar chart				
				ctx.beginPath();
				ctx.moveTo(30, 20);
				ctx.lineTo(30, 271);
				ctx.lineTo(985, 271);
				ctx.lineWidth = 2;
				ctx.strokeStyle = "#144C00";
				ctx.stroke();
				
				ctx.beginPath();
				ctx.moveTo(30, 10);
				ctx.lineTo(25, 20);
				ctx.lineTo(35, 20);
				ctx.closePath();
				ctx.fillStyle = "#144C00";
				ctx.fill();
				
				ctx.beginPath();
				ctx.moveTo(985, 267);
				ctx.lineTo(985, 275);
				ctx.lineTo(995, 270);
				ctx.fillStyle = "#144C00";
				ctx.fill();				
				
				var randomValue;
				var xPos = 30, yPos;
				for (var i = 0; i < 15; i++) {
					//Draw first column
					randomValue = randomFromTo(5, 200);
					yPos = 270 - randomValue;
					xPos += 30;
					if (randomValue > 150) {
						ctx.fillStyle = "#EFA840";
					} else {
						ctx.fillStyle = "#13AB60";
					}
					ctx.fillRect(xPos, yPos, 20, randomValue);
					//Draw second column
					randomValue = randomFromTo(5, 200);
					yPos = 270 - randomValue;
					xPos += 20;
					ctx.fillStyle = "#E45595";
					ctx.fillRect(xPos, yPos, 20, randomValue);
				}
			}
			
			function drawPieChart(x, y, radius, clear) {
				// Get canvas context
				var ctx = $("#pieChartCanvas").get(0).getContext("2d");
				// Clear current canvas
				if (clear) clearCanvas(ctx);
				
				var dataArr = [randomFromTo(5, 16), randomFromTo(5, 16), randomFromTo(5, 16), randomFromTo(5, 16), randomFromTo(5, 16), randomFromTo(5, 16)];
				var colorArr = ["#E55638", "#EFA840", "#13AB60", "#E45595", "#D6D74B", "#514D97", "#00B6DB"];
				
				var lastPiece = 100;
				for (var i = 0; i < dataArr.length; i++) {
					lastPiece -= dataArr[i];
				}
				dataArr.push(lastPiece);
				
				var lastAngle = getRadianFromPercent(-20);
				
				ctx.beginPath();
				ctx.arc(x, y, radius, 0, getRadianFromPercent(100), true);
				ctx.strokeStyle = "#9B7D6F";
				ctx.stroke();
				
				for (var i = 0; i < dataArr.length; i++) {
					ctx.beginPath();
					ctx.arc(x, y, radius - 5, lastAngle, lastAngle + getRadianFromPercent(dataArr[i]), false);
					ctx.lineTo(x, y);
					ctx.fillStyle = colorArr[i];
					ctx.fill();
					
					lastAngle += getRadianFromPercent(dataArr[i]);
				}
			}
			
			function getRadianFromPercent(percent) {
				var radianRoot = Math.PI / 180;
				return (360 * percent / 100) * radianRoot;
			}
			
			function randomFromTo(from, to){
			   return Math.floor(Math.random() * (to - from + 1) + from);
			}
			
			function clearCanvas(ctx) {
				var _ctx = ctx;
				if (_ctx == undefined || _ctx == null) {
					_ctx = $("#barChartCanvas").get(0).getContext("2d");
				}
				_ctx.clearRect(0,0,1000,400);
			}
		</script>
	</head>
	<body>
		<div id="wrapper">
			<p>
				<input type="button" onclick="drawCanvas()" value="Draw" />
				<input type="button" onclick="clearCanvas()" value="Clear" />
			</p>
			<canvas id="barChartCanvas" width="1000" height="300">
				Your browser does not support canvas.
			</canvas>
			<canvas id="pieChartCanvas" width="1000" height="400">
				Your browser does not support canvas.
			</canvas>
		</div>
	</body>
</html>